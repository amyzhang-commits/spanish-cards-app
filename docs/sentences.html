<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Process Sentences - Spanish Verb Trainer</title>

    <!-- PWA Meta Tags -->
    <meta name="description" content="Process Spanish sentences with automatic correction and translation">
    <meta name="theme-color" content="#1e40af">
    <link rel="manifest" href="/manifest.json">

    <!-- Icons for PWA -->
    <link rel="icon" type="image/x-icon" href="/icons/favicon.ico">
    <link rel="apple-touch-icon" href="/icons/icon-192.png">

    <!-- Styles -->
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="container">
        <!-- Offline Status Indicator -->
        <div id="offlineIndicator" class="offline-indicator" style="display: none;">
            📱 Working Offline
        </div>

        <!-- Sync Status Indicator -->
        <div id="syncIndicator" class="sync-indicator" style="display: none;">
            🔄 Syncing...
        </div>

        <header>
            <h1>🇪🇸 <span class="gradient-text">Spanish Verb Trainer</span></h1>
            <div class="status-bar">
                <span id="cardCount">0 cards stored locally</span>
                <span id="syncStatus">Ready</span>
            </div>
            <nav>
                <a href="index.html" class="nav-link">Generate Verbs</a>
                <a href="sentences.html" class="nav-link active">Process Sentences</a>
                <a href="study.html" class="nav-link">Study Cards</a>
                <a href="manage.html" class="nav-link">Manage Cards</a>
            </nav>
        </header>

        <main>
            <section class="sentence-processor-section">
                <h2>📝 Process Spanish Sentences</h2>
                <p>Paste sentences from your Google Sheet. I'll correct spelling, add accents, translate to English, and note verb tenses!</p>

                <div class="input-section">
                    <form id="sentenceForm">
                        <div class="form-group">
                            <label for="sentenceInput">Spanish Sentences or Fragments:</label>
                            <textarea
                                id="sentenceInput"
                                placeholder="Paste your Spanish sentences here, one per line or separated by periods...

For example:
Ayer fui al mercado
Me gusta mucho la musica
El esta estudiando para el examen"
                                rows="8"
                                required
                            ></textarea>
                            <small class="input-help">💡 Tip: Each line or sentence will be processed separately</small>
                        </div>
                        <button type="submit" id="processBtn">
                            <span class="btn-text">🔍 Process Sentences</span>
                            <span class="spinner" style="display: none;">🧠</span>
                        </button>
                    </form>
                </div>

                <!-- Loading Section -->
                <div id="loadingSection" class="loading-section" style="display: none;">
                    <div class="loading-animation">
                        <div class="spinner-large">🧠</div>
                        <p id="loadingText">Processing sentences...</p>
                        <small id="loadingSubtext">Correcting spelling, adding accents, and translating</small>
                    </div>
                </div>

                <!-- Results Section -->
                <div id="resultsSection" class="results-section" style="display: none;">
                    <div class="sentence-results">
                        <h4>📋 Processed Sentences</h4>
                        <div class="stats">
                            <span id="processedCount">0 sentences processed</span>
                        </div>

                        <div class="sentence-grid" id="sentenceGrid">
                            <!-- Processed sentences will be inserted here -->
                        </div>

                        <div class="action-buttons">
                            <button id="saveBtn" class="btn-primary">
                                💾 Save as Flashcards
                            </button>
                            <button id="processAnotherBtn" class="btn-secondary">
                                ➕ Process More Sentences
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Error Section -->
                <div id="errorSection" class="error-section" style="display: none;">
                    <div class="error-message">
                        <h4>❌ Processing Failed</h4>
                        <p id="errorText"></p>
                        <div class="error-actions">
                            <button id="retryBtn" class="btn-secondary">Try Again</button>
                            <button id="offlineBtn" class="btn-secondary" style="display: none;">
                                📱 Use Offline Mode
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Scripts -->
    <script src="/js/db.js"></script>
    <script src="/js/sync.js"></script>
    <script src="/js/sentences.js"></script>

    <!-- PWA Registration -->
    <script>
        // Register service worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>