<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Study Cards - Spanish Verb Trainer</title>

    <!-- PWA Meta Tags -->
    <meta name="description" content="Study Spanish flashcards with smart filtering">
    <meta name="theme-color" content="#1e40af">
    <link rel="manifest" href="manifest.json">

    <!-- Icons for PWA -->
    <link rel="icon" type="image/x-icon" href="icons/favicon.ico">
    <link rel="apple-touch-icon" href="icons/icon-192.png">

    <!-- Styles -->
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <!-- Offline Status Indicator -->
        <div id="offlineIndicator" class="offline-indicator" style="display: none;">
            📱 Working Offline
        </div>

        <!-- Sync Status Indicator -->
        <div id="syncIndicator" class="sync-indicator" style="display: none;">
            🔄 Syncing...
        </div>

        <header>
            <h1>🇪🇸 <span class="gradient-text">Spanish Verb Trainer</span></h1>
            <div class="status-bar">
                <span id="cardCount">0 cards stored locally</span>
                <span id="syncStatus">Ready</span>
            </div>
            <nav>
                <a href="index.html" class="nav-link">Generate Verbs</a>
                <a href="sentences.html" class="nav-link">Process Sentences</a>
                <a href="study.html" class="nav-link active">Study Cards</a>
                <a href="manage.html" class="nav-link">Manage Cards</a>
            </nav>
        </header>

        <main>
            <!-- Filter Section -->
            <section id="filterSection" class="filter-section">
                <h2>🎯 Study Session Setup</h2>
                <p>Choose what you want to study - filter by type, regularity, tenses, or specific verbs</p>

                <div class="filter-grid">
                    <!-- Card Type Filter -->
                    <div class="filter-group">
                        <h3>📚 Card Type</h3>
                        <div class="filter-options">
                            <label class="filter-option">
                                <input type="radio" name="cardType" value="all" checked>
                                All Cards
                            </label>
                            <label class="filter-option">
                                <input type="radio" name="cardType" value="verb">
                                Verb Conjugations Only
                            </label>
                            <label class="filter-option">
                                <input type="radio" name="cardType" value="sentence">
                                Sentences Only
                            </label>
                        </div>
                    </div>

                    <!-- Verb Regularity Filter (for verb cards) -->
                    <div class="filter-group" id="regularityGroup">
                        <h3>⚙️ Verb Type</h3>
                        <div class="filter-options">
                            <label class="filter-option">
                                <input type="radio" name="regularity" value="all" checked>
                                All Verbs
                            </label>
                            <label class="filter-option">
                                <input type="radio" name="regularity" value="regular">
                                Regular Verbs Only
                            </label>
                            <label class="filter-option">
                                <input type="radio" name="regularity" value="irregular">
                                Irregular Verbs Only
                            </label>
                        </div>
                    </div>

                    <!-- Specific Verb Filter -->
                    <div class="filter-group" id="verbGroup">
                        <h3>🎯 Specific Verb</h3>
                        <select id="verbSelect" class="filter-select">
                            <option value="">All Verbs</option>
                        </select>
                    </div>

                    <!-- Tense & Mood Filter -->
                    <div class="filter-group" id="tenseMoodGroup">
                        <h3>📚 Tense & Mood</h3>
                        <select id="tenseMoodSelect" class="filter-select">
                            <option value="">All Tenses & Moods</option>

                            <optgroup label="📊 Indicative Mood">
                                <option value="present_indicative">Present Indicative</option>
                                <option value="preterite_indicative">Preterite</option>
                                <option value="imperfect_indicative">Imperfect</option>
                                <option value="future_indicative">Future</option>
                                <option value="present_perfect_indicative">Present Perfect</option>
                                <option value="past_perfect_indicative">Past Perfect</option>
                                <option value="future_perfect_indicative">Future Perfect</option>
                            </optgroup>

                            <optgroup label="🤔 Subjunctive Mood">
                                <option value="present_subjunctive">Present Subjunctive</option>
                                <option value="imperfect_subjunctive">Imperfect Subjunctive</option>
                                <option value="future_subjunctive">Future Subjunctive</option>
                                <option value="present_perfect_subjunctive">Present Perfect Subjunctive</option>
                                <option value="past_perfect_subjunctive">Past Perfect Subjunctive</option>
                            </optgroup>

                            <optgroup label="💭 Conditional Mood">
                                <option value="simple_conditional">Simple Conditional</option>
                                <option value="perfect_conditional">Perfect Conditional</option>
                            </optgroup>

                            <optgroup label="⚡ Imperative Mood">
                                <option value="affirmative_imperative">Affirmative Imperative</option>
                                <option value="negative_imperative">Negative Imperative</option>
                            </optgroup>
                        </select>
                    </div>
                </div>

                <div class="session-info">
                    <div class="card-count" id="matchingCount">0 cards match your filters</div>
                    <button id="startStudyBtn" class="start-btn" disabled>
                        🚀 Start Study Session
                    </button>
                </div>
            </section>

            <!-- Study Session -->
            <section id="studySection" class="study-session" style="display: none;">
                <div class="study-header">
                    <div class="study-progress">
                        <span id="currentCard">1</span> / <span id="totalCards">0</span>
                        <span class="side-stack-count" id="sideStackCount" style="display: none;">
                            📚 <span id="sideStackNumber">0</span> in side stack
                        </span>
                    </div>
                    <button id="endStudyBtn" class="btn-secondary">End Session</button>
                </div>

                <div class="flashcard-container">
                    <div class="flashcard" id="flashcard">
                        <div class="card-front" id="cardFront">
                            <div class="card-content">
                                <!-- Card content will be inserted here -->
                            </div>
                        </div>
                        <div class="card-back" id="cardBack" style="display: none;">
                            <div class="card-content">
                                <!-- Card answer will be inserted here -->
                            </div>
                        </div>
                    </div>
                </div>

                <div class="study-controls">
                    <button id="revealBtn" class="btn-primary reveal-btn">
                        👁️ Reveal Answer
                    </button>

                    <div id="actionButtons" class="action-buttons" style="display: none;">
                        <button id="sideStackBtn" class="btn-side-stack">
                            📚 Side Stack
                        </button>
                        <button id="nextBtn" class="btn-primary">
                            ➡️ Next Card
                        </button>
                    </div>
                </div>
            </section>

            <!-- Session Complete -->
            <section id="completeSection" class="session-complete" style="display: none;">
                <div class="complete-message">
                    <h3>🎉 Session Complete!</h3>
                    <p id="sessionSummary">You've studied all cards in this session.</p>

                    <div id="sideStackReview" class="side-stack-review" style="display: none;">
                        <p>You have <span id="finalSideStackCount">0</span> cards in your side stack.</p>
                        <button id="reviewSideStackBtn" class="btn-primary">
                            📚 Review Side Stack
                        </button>
                    </div>

                    <div class="complete-actions">
                        <button id="newSessionBtn" class="btn-primary">
                            🔄 New Session
                        </button>
                        <button id="backToFilterBtn" class="btn-secondary">
                            ⚙️ Change Filters
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Scripts -->
    <script src="js/db.js"></script>
    <script src="js/sync.js"></script>
    <script src="js/study.js"></script>

    <!-- PWA Registration -->
    <script>
        // Register service worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>